# to edit: do an evaluation every {eval_interval} iterations
eval_interval = 2000
eval_iters = 1
always_save_checkpoint = True

wandb_log = True # override via command line if you like
wandb_project = '4_op_addition'

# to edit: wandb run name
wandb_run_name = '20M_4_operands_0_to_999_uniform_plain'

# baby GPT model :)
n_layer = 12
n_head = 12
n_embd = 384
dropout = 0.2

# to edit: 'plain' or 'reverse' or 'scratchpad' or 'max' or 'sorting'
data_format='plain'
operator='+'
dataset = 'bal'
batch_size = 512
block_size = 32 # context of up to 256 previous characters

# to edit: 'scratch' or 'resume', whether train from scratch or resume from a saved checkpoint
init_from = 'scratch'
iter_num = 0


# to edit: max number of digits in each operand
num_digit = 3

# to edit: maximum number of output tokens (including '$')
max_new_tokens = 5

drop_leading_digit = False

# ===== Learning Rate Policy ===== #
learning_rate = 1e-3

# to edit: the number of training iterations
max_iters = 400000 # for four operands addition, recommend >= 200000
lr_decay_iters = 400000 # make equal to max_iters

beta1 = 0.9
beta2 = 0.98
warmup_iters = 500

# ===== Device ===== #
device='cuda:0'

# to edit: the output directory; Path is relative to the project's main directory. 
# For example, the project's main directory might be "/content/drive/MyDrive/addition/"
out_dir = '/content/drive/MyDrive/addition_1/4_operands_1M/20M_plain_out'

# to edit: data directory; Path is relative to the project's main directory. 
data_dir = '/content/drive/MyDrive/addition/data/4_operands_0_to_999_uniform'

# to edit: training data
train_data_name = 'train.txt'

# to edit: whether do evaluation on training data to see if the model is simply memorizing
eval_addition_train = True
train_data_test_name = "train_eval.txt"

# to edit: validation data
val_data_name = 'val.txt'

# to edit: test data; It can be either without gold (thus gold by computing) or with gold (thus gold by reading)
# "test_file_name" can be either a single file, or the name of the directory that contains multiple test files 
# "main_test_name" is the name, without extension, of the test file (in case there are multiple test files) that's to be displayed in wandb
eval_addition = True
test_file_name = 'test.txt'
main_test_name = "test"

# to edit: "compute_gold" or "read_gold_as_str"; read or compute groundtruth in evaluation data
mode = "read_gold_as_str"

# to edit: Can be 'units', 'tens', 'hundreds', 'thousands', or None
randomize = 'None'

# to edit: whether do mutual information tacking (addition supported only)
mi_measurement = False